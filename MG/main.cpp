#include "MG.h"

#include <iostream>
#include <vector>

#include "CSRMatrix.h"

using namespace std;

void printVec(vector<double> &X) {
  // Output the solution
  cout << "[";
  for (auto Val : X) {
    cout << Val << " ";
  }
  cout << "]" << endl;
}

int main() {

  // Laplace equation on unit square
  CSRMatrix A(25, 25);

  A.Offsets = {0,  3,  7,  11, 14, 16, 20, 25, 30, 34, 37, 41, 46,
               51, 55, 58, 62, 67, 72, 76, 79, 82, 86, 90, 94, 97};

  A.ColIdx = {0,  1,  5,  0,  1,  2,  6,  1,  2,  3,  7,  2,  3,  8,
              4,  9,  0,  5,  6,  10, 1,  5,  6,  7,  11, 2,  6,  7,
              8,  12, 3,  7,  8,  13, 4,  9,  14, 5,  10, 11, 15, 6,
              10, 11, 12, 16, 7,  11, 12, 13, 17, 8,  12, 13, 18, 9,
              14, 19, 10, 15, 16, 20, 11, 15, 16, 17, 21, 12, 16, 17,
              18, 22, 13, 17, 18, 23, 14, 19, 24, 15, 20, 21, 16, 20,
              21, 22, 17, 21, 22, 23, 18, 22, 23, 24, 19, 23, 24};

  A.Values = {-4.0, 1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,
              1.0,  -4.0, 1.0,  -4.0, 1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  1.0,
              -4.0, 1.0,  1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  1.0,  -4.0,
              1.0,  1.0,  -4.0, 1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  1.0,  -4.0,
              1.0,  1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  1.0,  -4.0, 1.0,
              1.0,  -4.0, 1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  1.0,  -4.0, 1.0,
              1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,
              -4.0, 1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,
              -4.0, 1.0,  1.0,  1.0,  -4.0, 1.0,  1.0,  1.0,  -4.0};

  vector<double> B = {0.0, 0.0, 0.0, 0.0,   0.0,   0.0,   0.0, 0.0, 0.0,
                      0.0, 0.0, 0.0, 0.0,   0.0,   0.0,   0.0, 0.0, 0.0,
                      0.0, 0.0, 0.0, 100.0, 100.0, 100.0, 0.0};


  vector<double> *X = mgVCycle(&A, &B);

  cout << "Approximation:" << endl;
  printVec(*X);

  vector<double> Sol = {
      -1.88399119,  -3.2008312,   -3.36004712,  -2.16462856,  -0.06170587,
      -4.33513354,  -7.55928651,  -8.07472871,  -5.29846711,  -0.24682348,
      -7.89725646,  -14.62645258, -16.0811141,  -10.95451117, -0.92558805,
      -12.62743971, -26.96815326, -30.66876393, -22.43846348, -3.45552874,
      -15.64434913, -49.94995682, -57.18732489, -48.13057882, -12.89652689};

  cout << "Solution:" << endl;
  printVec(Sol);

  return 0;
}
